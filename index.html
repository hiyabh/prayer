<!DOCTYPE html>
<html lang="he" dir="rtl">
  <head>
    <meta charset="UTF-8">
    
    <!-- Security Headers -->
    <meta http-equiv="Content-Security-Policy" 
          content="default-src 'self' https://*.firebaseio.com https://*.googleapis.com; 
                   script-src 'self' https://www.gstatic.com https://cdn.tailwindcss.com https://*.firebaseio.com https://*.googleapis.com 'unsafe-inline'; 
                   style-src 'self' https://fonts.googleapis.com 'unsafe-inline'; 
                   font-src 'self' https://fonts.gstatic.com;
                   connect-src 'self' https://*.firebaseio.com https://*.googleapis.com;
                   img-src 'self' https://blogger.googleusercontent.com https://cdn.jsdelivr.net;
                   worker-src 'self' https://*.firebaseio.com https://*.googleapis.com;">
    <meta http-equiv="X-Frame-Options" content="DENY">
    <meta http-equiv="X-Content-Type-Options" content="nosniff">
    <meta http-equiv="Referrer-Policy" content="strict-origin-when-cross-origin">
    
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>שמות החטופים תפילה</title>
    
    <!-- תיאור האתר -->
    <meta name="description" content="שמות החטופים לתפילה - קבל שם אקראי של חטוף/ה לתפילה וצפה סטטיסטיקות של השמות הנבחרים">
    <meta property="og:title" content="שמות החטופים לתפילה">
<meta property="og:description" content="קבל שם אקראי של חטוף/ה לתפילה וצפה בסטטיסטיקות של השמות הנבחרים">
<meta property="og:image" content="https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEjP4BnZGRu3lKKBVRNjzTmgKl431LV3_ZLJplBx-aEw02I_-Gb6JIt9F_3LRdIEFMi2VwIw4d2CfcPTiAeEuaEBz9obxLr5NRTu3BW8YyBZVx9UkFOTJ4ACeI0Vw0naFlV2r2DIrLSi3eUMuOd-YWLEJmX_liJg9pgOQEAxA1EVlAhcpj62M9Zu1tv_HasP/s320/WhatsApp%20Image%202024-08-22%20at%2000.19.32.jpeg">

    <!-- אייקון האתר -->
    <link rel="icon" href="https://cdn.jsdelivr.net/npm/@mdi/svg@7.2.96/svg/pray.svg" type="image/svg+xml">
    
    <script src="https://cdn.tailwindcss.com"></script>
 <script type="module">
// Firebase configuration
const firebaseConfig = {
  apiKey: "AIzaSyBcuwDI1n17evwg7YxeI6twTNVWZL9jb1Y",
  authDomain: "prayer-e0df2.firebaseapp.com",
  databaseURL: "https://prayer-e0df2-default-rtdb.europe-west1.firebasedatabase.app",
  projectId: "prayer-e0df2",
  storageBucket: "prayer-e0df2.appspot.com",
  messagingSenderId: "1093380327772",
  appId: "1:1093380327772:web:0ce40c6aee3d54ac4c9999",
  measurementId: "G-4PE5V4C1H5",
};

import { initializeApp } from "https://www.gstatic.com/firebasejs/10.7.1/firebase-app.js";
import { getDatabase, ref, onValue, set } from "https://www.gstatic.com/firebasejs/10.7.1/firebase-database.js";

// Initialize Firebase
const app = initializeApp(firebaseConfig);
const database = getDatabase(app);

// רשימת שמות לתפילה
const names = [
  "אבינתן בן דיצה תרצה (אור)",
  "אביתר בן גליה (דוד)",
  "אברהם אברה בן אגרנש (מנגיסטו)",
  "אגם בת מירב (ברגר)",
  "אוהד בן קרן אסתר (בן עמי)",
  "אוהד בן אסתר (יהלומי)",
  "אור בן סימה גאולה (לוי)",
  "איתן בן רות אדית (הורן)",
  "איתן אברהם בן אפרת (מור)",
  "אלון בן עידית (אהל)",
  "אליה בן סיגלית (כהן)",
  "אליהו בן חנה (שרעבי)",
  "אליזבת בת אירנה (צורקוב) מוחזקת בעירק",
  "אלכסנדר סשה בן ילנה (טרופנוב)",
  "אלקנה בן רוחמה (בוחבוט)",
  "אמילי תהילה בת אמנדה פרנסיס (דמארי)",
  "אריאל בן סילביה מוניקה (קוניו)",
  "אריאל בן שירי (ביבס)",
  "ארבל בת יעל (יהוד)",
  'אוריאל בן נעמי (ברוך) הי"ד',
  'אביב בן תלמה (אצילי) הי"ד',
  'אורון בן זהבה (שאול) הי"ד',
  'אילן שלמה בן מרים (וייס) הי״ד',
  'איתי בן אורית (סבירסקי) הי"ד',
  'איתי בן חגית (חן) הי"ד',
  'איתן בן סול (לוי) הי"ד',
  'אליהו בן דבורה (מרגלית) הי״ד',
  'אל׳מ אסף בן קלרה (חממי) הי׳ד',
  'אריה בן צבי (זלמנוביץ) הי״ד',
  "בר אברהם בן ג'וליה (קופרשטיין)",
  "גיא בן מירב (גלבוע דלאל)",
  "גדי משה בן שרה (מוזס)",
  "גלי בן תמר טליה (ברמן) (מוחזק יחד עם אחיו זיו)",
  'גד בן שרה (חגי) הי"ד',
  'גיא בן דוריס (אילוז) הי׳ד',
  'גיא בן רינה (חבר) הי"ד',
  "דוד דיגו בן סילביה מוניקה (קוניו)",
  "דורון בת שרה (סימונה) שטיינברכר",
  "דניאלה בת אורלי (גלבוע)",
  'דניאל שמעון בן שרון (פרץ) הי"ד',
  'דרור בן דורית (אור) הי׳ד',
  'הדר בן חדווה לאה (גולדין) הי"ד',
  "זיו בן תמר טליה (ברמן) (מוחזק יחד עם אחיו גלי)",
  "טל בן ניצה (שוהם)",
  'טל בן אסתר (חיימי) הי"ד',
  "יאיר בן רות אדית (הורן)",
  "יוסף חיים בן מרים (אוחנה)",
  "יצחק איציק בן חנה אנטה (אלגרט)",
  "יקותיאל קית׳ שמואל בן טובה (סיגל)",
  "יקותיאל יהודה נחמן בן שרה (כץ)",
  "ירדן בן פנינה (ביבס)",
  'יהודית לין בת מרלין (ויינשטיין) הי"ד',
  'יהונתן מרדכי בן איילת (סמרנו) הי״ד',
  'יוסף בן חנה (שרעבי) הי"ד',
  'יאיר בן פלור (יעקב) הי׳ד',
  "כפיר בן שירי (ביבס)",
  "לירי בת שירה (אלבג)",
  'ליאור בן מיכל (רודאיף) הי"ד',
  "מקסים בן טלה נטשה (הרקין)",
  "מתן שחר בן ענת (אנגרסט)",
  "מתן בן ירדנה עינב (צנגאוקר)",
  'מני בן סוניה גודארד הי׳ד',
  "נמרוד בן ויקי (כהן)",
  "נעמה בת איילת (לוי)",
  'סהר בן תמר (ברוך) הי"ד',
  "עומרי בן ורוניקה אסתר (מירן)",
  "עודד בן בלהה (ליפשיץ)",
  "עומר מקסים בן אורנה אסתר (נאוטרה)",
  "עומר בן שלי (שם טוב)",
  "עומר בנימין בן ניבה (ונקרט)",
  "עופר בן כוכבה (קלדרון)",
  "עידן בן דלית (שתיוי)",
  "עידן בן יעל (אלכסנדר)",
  'עוז בן מירב (דניאל) הי"ד',
  'עמירם בן שרה (קופר) הי״ד',
  'ענבר בת יפעת (היימן) הי״ד',
  'עפרה בת פנינה (קידר) הי״ד',
  "צחי בן דבורה (עידן)",
  'צבי בן פנינה (פלדמן) הי"ד',
  "קרינה בת אירה (ארייב)",
  "רומי בת מירב (גונן)",
  "רום בן תמר (ברסלבסקי)",
  'רון בן בתיה (ארד) הי"ד',
  'רונן בן רוזמרי (אנגל) הי״ד',
  'רן בן טלי (גואילי) הי"ד',
  "שגב בן גלית (כלפון)",
  "שגיא בן נעמית (דקל חן)",
  "שירי בת מרגיט (זילברמן-ביבס)",
  "שלמה אסעד בן מרסל (מנצור)",
  "שמואל בן גלדיס (סיגל)",
  'שי בן שלומית שרית (לוינסון) הי׳ד',
  'שקד בן סיגלית (דהן) הי"ד',
  "תמיר בן חרות (נמרודי)",
  'תמיר בן יעל (אדר) הי״ד',
  "יוסף חמיס אל-זיאדנה",
  "חמזה אל-זיאדנה",
  "הישאם א-סייד",
  "ביפין גושי",
  "ג'ושוע לואיטו מולל"
];

let namesCount = {};
let totalCount = 0;

// הוספת משתנה גלובלי לניהול הגבלת קצב
let lastClickTime = 0;
const CLICK_DELAY = 2000; // 2 שניות בין לחיצות

// טעינת נתונים מ-Firebase
async function loadData() {
  console.log("Starting loadData...");
  
  // אתחול ערכים התחלתיים
  names.forEach((name) => {
    namesCount[name] = 0;
  });
  
  // עדכון ראשוני של הרשימה
  updateNamesList();
  
  const namesCountRef = ref(database, "namesCount");
  onValue(namesCountRef, (snapshot) => {
    console.log("Got data from Firebase:", snapshot.val());
    const data = snapshot.val();
    if (data) {
      namesCount = data;
      // וידוא שכל השמות קיימים
      names.forEach((name) => {
        if (!namesCount[name]) namesCount[name] = 0;
      });
      console.log("Updated namesCount:", namesCount);
      updateNamesList();
    }
  });

  const totalCountRef = ref(database, "totalCount");
  onValue(totalCountRef, (snapshot) => {
    totalCount = snapshot.val() || 0;
  });
}

function updateNamesList() {
  console.log("Running updateNamesList...");
  const namesList = document.getElementById("namesList");
  if (!namesList) {
    console.error("namesList element not found!");
    return;
  }
  
  // מחיקת התוכן הקיים
  while (namesList.firstChild) {
    namesList.removeChild(namesList.firstChild);
  }
  
  // הוספת השמות החדשים
  Object.entries(namesCount)
    .sort((a, b) => b[1] - a[1])
    .forEach(([name, count], index) => {
      const li = document.createElement("li");
      const div = document.createElement("div");
      const numberSpan = document.createElement("span");
      const textSpan = document.createElement("span");
      
      numberSpan.className = "name-number";
      numberSpan.textContent = `${index + 1}.`;
      
      textSpan.className = "name-text";
      textSpan.textContent = name;
      
      div.appendChild(numberSpan);
      div.appendChild(textSpan);
      li.appendChild(div);
      namesList.appendChild(li);
    });
  console.log("Finished updating names list");
}

// טעינת הנתונים בעת טעינת הדף
document.addEventListener('DOMContentLoaded', () => {
  console.log("DOM loaded, calling loadData...");
  loadData();
});

// עדכון פונקציות המודל
function showModal(name) {
    const modal = document.getElementById('nameModal');
    document.getElementById('modalResult').textContent = name;
    modal.classList.add('show');
    document.body.style.overflow = 'hidden'; // מונע גלילה ברקע
}

function hideModal() {
    const modal = document.getElementById('nameModal');
    modal.classList.remove('show');
    document.body.style.overflow = ''; // מחזיר את הגלילה
}

// עדכון event listeners
document.getElementById('generateBtn').addEventListener('click', () => {
    const currentTime = Date.now();
    if (currentTime - lastClickTime < CLICK_DELAY) {
        alert('נא להמתין מספר שניות לפני בקשה חדשה');
        return;
    }
    lastClickTime = currentTime;

    const randomName = names[Math.floor(Math.random() * names.length)];
    namesCount[randomName] = (namesCount[randomName] || 0) + 1;
    totalCount++;
    updateNamesList();
    saveData();
    
    showModal(randomName);
});

document.getElementById('shareModal').addEventListener('click', () => {
    hideModal();
});

document.getElementById('closeModal').addEventListener('click', () => {
    // פונקציית ההעתקה
    const modalResult = document.getElementById('modalResult').textContent;
    
    // אוסף את כל הכותרות והטקסטים של התפילות
    const sections = Array.from(document.querySelectorAll('.prayer-section')).map(section => {
        const title = section.querySelector('h3').textContent;
        const prayers = Array.from(section.querySelectorAll('.prayer-text'))
            .map(prayer => prayer.textContent.trim())
            .join('\n\n');
        return `${title}\n${'-'.repeat(title.length)}\n\n${prayers}`;
    }).join('\n\n\n');
    
    // מרכיב את הטקסט המלא
    const textToCopy = `${modalResult}\n\n${sections}`;
    
    navigator.clipboard.writeText(textToCopy)
        .then(() => {
            alert('התוכן הועתק בהצלחה!');
            hideModal();
        })
        .catch(err => {
            console.error('שגיאה בהעתקה:', err);
            alert('אירעה שגיאה בהעתקת התוכן');
        });
});

// סגירת המודל בלחיצה על הרקע
document.getElementById('nameModal').addEventListener('click', (event) => {
    if (event.target === event.currentTarget) {
        hideModal();
    }
});

// עדכון פונקציית saveData
async function saveData() {
  // וולידציה של הנתונים לפני שמירה
  if (typeof totalCount !== 'number' || totalCount < 0) {
    console.error('Invalid totalCount value');
    return;
  }

  // בדיקת תקינות של namesCount
  for (const [name, count] of Object.entries(namesCount)) {
    if (typeof count !== 'number' || count < 0) {
      console.error(`Invalid count for name: ${name}`);
      return;
    }
    if (!names.includes(name)) {
      console.error(`Invalid name: ${name}`);
      return;
    }
  }

  try {
    await set(ref(database, "namesCount"), namesCount);
    await set(ref(database, "totalCount"), totalCount);
  } catch (error) {
    console.error("Error saving data:", error);
    alert("אירעה שגיאה בשמירת הנתונים");
  }
}
</script>
    <style>
 @import url('https://fonts.googleapis.com/css2?family=Heebo:wght@300;400;700&display=swap');

:root {
    --primary-color: #4338ca;
    --primary-color-rgb: 67, 56, 202;
    --secondary-color: #818cf8;
    --background-color: #f3f4f6;
    --text-color: #1f2937;
    --white: #ffffff;
}

* {
    margin: 0;
    padding: 0;
    box-sizing: border-box;
}

body {
    font-family: 'Heebo', sans-serif;
    background: linear-gradient(135deg, var(--background-color), var(--secondary-color));
    color: var(--text-color);
    min-height: 100vh;
    display: flex;
    flex-direction: column;
    align-items: center;
    padding: 2rem 1rem;
}

.container {
    width: 100%;
    max-width: 800px;
    text-align: center;
}

h1, .fancy-title {
    font-size: 2.5rem;
    color: var(--primary-color);
    margin-bottom: 2rem;
    text-align: center;
    position: relative;
    padding: 0.5rem 0;
    background: linear-gradient(135deg, var(--primary-color), var(--secondary-color));
    -webkit-background-clip: text;
    background-clip: text;
    color: transparent;
    text-shadow: 2px 2px 4px rgba(0, 0, 0, 0.1);
}

h1::after, .fancy-title::after {
    content: '';
    position: absolute;
    bottom: 0;
    left: 50%;
    transform: translateX(-50%);
    width: 50%;
    height: 3px;
    background: linear-gradient(90deg, transparent, var(--primary-color), transparent);
}

#counter {
    background-color: var(--white);
    color: var(--primary-color);
    padding: 0.5rem 1rem;
    border-radius: 9999px;
    font-weight: bold;
    font-size: 1.25rem;
    display: inline-block;
    margin-bottom: 2rem;
    box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
}

.card {
    background-color: var(--white);
    border-radius: 1rem;
    padding: 2rem;
    margin-bottom: 2rem;
    box-shadow: 0 10px 15px rgba(0, 0, 0, 0.1);
}

#generateBtn {
    background: linear-gradient(135deg, var(--primary-color), var(--secondary-color));
    color: var(--white);
    border: none;
    padding: 1rem 2rem;
    font-size: 1.25rem;
    font-weight: bold;
    border-radius: 0.5rem;
    cursor: pointer;
    transition: transform 0.3s, box-shadow 0.3s;
    width: 100%;
}

#generateBtn:hover {
    transform: translateY(-3px);
    box-shadow: 0 6px 12px rgba(0, 0, 0, 0.15);
}

#result {
    margin-top: 1rem;
    font-size: 1.5rem;
    font-weight: bold;
    color: var(--primary-color);
}

#namesList {
    list-style-type: none;
    padding: 0;
}

#namesList li {
    display: flex;
    justify-content: space-between;
    align-items: center;
    padding: 0.75rem 1rem;
    border-bottom: 1px solid #e5e7eb;
    transition: background-color 0.3s;
}

#namesList li:last-child {
    border-bottom: none;
}

#namesList li:hover {
    background-color: #f9fafb;
}

.name-number {
    color: var(--secondary-color);
    font-weight: bold;
    margin-right: 0.5rem;
}

.name-text {
    font-size: 1.25rem;
}

.name-count {
    background-color: var(--primary-color);
    color: var(--white);
    padding: 0.25rem 0.75rem;
    border-radius: 9999px;
    font-weight: bold;
}

/* Modal Styles */
.modal {
    display: none;
    position: fixed;
    z-index: 1000;
    left: 0;
    top: 0;
    width: 100%;
    height: 100%;
    background-color: rgba(0, 0, 0, 0.5);
    opacity: 0;
    transition: opacity 0.3s ease-in-out;
}

.modal.show {
    display: flex;
    opacity: 1;
}

.modal-content {
    background-color: var(--white);
    margin: auto;
    padding: 2rem;
    border-radius: 1rem;
    width: 90%;
    max-width: 600px;
    transform: translateY(-20px);
    transition: transform 0.3s ease-in-out;
    box-shadow: 0 10px 25px rgba(0, 0, 0, 0.2);
    max-height: 90vh;
    overflow-y: auto;
}

.modal.show .modal-content {
    transform: translateY(0);
}

.modal-buttons {
    display: flex;
    gap: 1rem;
    margin-top: 2rem;
}

.modal-button {
    flex: 1;
    padding: 0.75rem 1.5rem;
    border: none;
    border-radius: 0.5rem;
    font-weight: bold;
    cursor: pointer;
    transition: transform 0.2s, box-shadow 0.2s;
    font-size: 1.1rem;
}

.modal-button.primary {
    background: var(--primary-color);
    color: white;
}

.modal-button.secondary {
    background: var(--background-color);
    color: var(--text-color);
}

.modal-button:hover {
    transform: translateY(-2px);
    box-shadow: 0 4px 8px rgba(0, 0, 0, 0.1);
}

.modal-button:active {
    transform: translateY(0);
}

.modal-result {
    font-size: 1.5rem;
    font-weight: bold;
    text-align: center;
    margin: 1.5rem 0;
    padding: 1rem;
    background: linear-gradient(135deg, var(--background-color), var(--white));
    border-radius: 0.5rem;
    color: var(--primary-color);
}

.prayer-section {
    margin: 2rem 0;
    padding: 1rem;
    background-color: rgba(var(--primary-color-rgb), 0.05);
    border-radius: 0.5rem;
}

.prayer-section h3 {
    color: var(--primary-color);
    border-bottom: 2px solid var(--secondary-color);
    padding-bottom: 0.5rem;
    margin-bottom: 1rem;
    font-size: 1.3rem;
    text-align: center;
}

.prayer-text {
    font-size: 1.1rem;
    line-height: 1.8;
    margin-bottom: 1rem;
    color: var(--text-color);
    text-align: right;
}

.prayer-text:last-child {
    margin-bottom: 0;
}

/* הגדלת המרווח בין הפסקאות */
.prayer-text + .prayer-text {
    margin-top: 1rem;
}

@media (max-width: 640px) {
    .prayer-section {
        padding: 0.75rem;
        margin: 1.5rem 0;
    }

    .prayer-section h3 {
        font-size: 1.1rem;
    }

    .prayer-text {
        font-size: 1rem;
        line-height: 1.6;
    }
}

.modal-info {
    text-align: center;
    margin: 1rem 0;
    padding: 1rem;
    background-color: rgba(var(--primary-color-rgb), 0.1);
    border-radius: 0.5rem;
}

.modal-info p {
    margin: 0.5rem 0;
    color: var(--text-color);
    font-size: 1.1rem;
}

@media (max-width: 640px) {
    .modal-info p {
        font-size: 1rem;
    }
}
</style>
  </head>
  <body>
    <br class="container">
      <h1 class="fancy-title">
    <span class="title-text" data-text="">רשימת שמות החטופים לתפילה</span>
</h1>
<br />
      <!-- <div id="counter"></div> -->

      <div class="card">
        <button id="generateBtn">קבל שם חטוף/ה לתפילה</button>
        <p id="result"></p>
      </div>

      <div class="card">
        <h2 class="fancy-title">
    <span class="title-text" data-text="">רשימת שמות החטופים לתפילה</span>
</h2>
        <ul id="namesList"></ul>
      </div>
    </div>
    <div id="nameModal" class="modal">
    <div class="modal-content">
        <h2>שם החטוף/ה שנבחר לתפילה עבורך</h2>
        <div id="modalResult" class="modal-result"></div>
        <div class="modal-info">
            <p>התפלל/י לשלומו/ה ולשחרורו/ה המהיר.</p>
            <p>אנא המשיכו להתפלל ולבקש על שחרורם המהיר של כל החטופים.</p>
        </div>
        
        <div class="prayer-section">
            <h3>תפילה לחטופים החיים</h3>
            <p class="prayer-text">
                מי שברך אבותינו הקדושים אברהם יצחק יעקב משה אהרן יוסף ודוד, הוא יברך וישמור ויציל את כל העצורים והנעדרים בתוך שאר אחינו בית ישראל הנתונים בצרה ובשביה.
            </p>
            <p class="prayer-text">
                הקדוש ברוך הוא מלא רחמים עליהם, ויוציאם מחשך לאור, ומשעבוד לגאולה, ומצרותיהם יושיעם. ישיבם מהרה לחיק משפחותיהם ברינה ובשלום.
            </p>
            <p class="prayer-text">
                בעל הרחמים ירחם על משפחותיהם המצפות, יחזק את רוחם ויתן להם כח ותקוה עד שובי יקיריהם.
            </p>
            <p class="prayer-text">
                ויקוים בהם מקרא שכתוב: "ופדויי ה' ישובון ובאו ציון ברנה ושמחת עולם על ראשם, ששון ושמחה ישיגו ונסו יגון ואנחה".
            </p>
        </div>

        <div class="prayer-section">
            <h3>תפילה לזכר הנופלים והנרצחים</h3>
            <p class="prayer-text">
                המרחם על כל בריותיו הוא יחוס וירחם וירחם על נפש, רוח ונשמה של הנרצחים והנופלים בקרב, בין אלו שגופתם מחזקת ביד אויב, ובין אלו שמקום קבורתם לא נודע.
            </p>
            <p class="prayer-text">
                מלך מלכי המלכים ברחמיו ירחם עליהם, יחוס ונשמתם ויאספם לנדר ישראל במנוחה נכונה. בעל הרחמים ירחם על משפחתם, ינחמם בגאולם ויעלה מזור לכאבם.
            </p>
            <p class="prayer-text">
                דורש דמים ידרוש דמם מיד רוצחיהם, שוביהם ומעניהם. ה' הוא נקמות, בעל עדן תהא מנוחתם, וינוחו בשלום על משכבותם.
            </p>
            <p class="prayer-text">
                ותעמוד לכל ישראל זכותם, ויעמדו לעולם לקץ הימין. אמן כן יהי רצון
            </p>
        </div>

        <div class="modal-buttons">
            <button id="shareModal" class="modal-button primary">אתפלל בשמחה</button>
            <button id="closeModal" class="modal-button secondary">העתק</button>
        </div>
    </div>
</div>
</div>
</div>
  </body>
</html>
